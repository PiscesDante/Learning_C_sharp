# 第2章 C#编程概述

本章内容：一个简单的C#程序、标识符、关键字、Main：程序的起点、空白、语句、从程序输出的文本。

## 2.1 一个简单的C#程序

```C#
using System;

namespace Simple
{
    class Program
    {
        static void Main()
        {
            Console.WriteLine("Hi, there!");
        }
    }
}
```

SimpleProgram程序的逐行描述：

* 行1：告诉编译器这个程序使用`System`命名空间的类型
* 行3：声明一个新的命名空间，名称为`Simple`
    * 新的命名空间从第4行一直延续到第12行；
    * 在这部分里声明的任何类型都是该命名空间的成员；
* 行5：声明一个新的类型，名称为`Program`
    * 任何在第6行和第11行之间声明的成员都是组成这个类的成员；
* 行7：声明一个名称为`Main`的方法作为类`Program`的成员
    * 在这个程序中，`Main`是`Program`类的唯一成员；
    * `Main`是一个特殊的函数，编译器用它作为程序的起始点；
* 行9：只包含一条单独的、简单的语句，这一行组成了`Main`的方法体
    * 简单语句以一个分号结束；
    * 这条语句使用命名空间`System`中的一个名称为`Console`的类将消息输出到屏幕窗口；
    * 没有第1行的`using`语句，编译器就不会知道在哪里找类`Console`；

#### SimpleProgram的补充说明

**<u>C#程序由一个或者多个类型声明组成</u>**。**<u>程序中的类型可以以任何顺序声明</u>**。在SimpleProgram程序中，我们只声明了`class`类型。

命名空间是与某个名称相关联的一组类型声明。SimpleProgram使用两个命名空间。它创建了一个名称为`Simple`的新命名空间，并在其中声明了其类型（`class Program`），还使用了`System`命名空间中定义的`Console`类。

## 2.2 标识符

**<u>标识符是一种字符串，用来命名如变量、方法、参数和许多后面将要阐述的其他程序结构</u>**。

* 字母和下划线可以用在任何位置。
* 数字不能放在首位，但是可以放在其他的任何地方。
* @字符只能放在标识符的首位。虽然可以使用，但强烈不推荐。
* 标识符区分大小写。

## 2.3 关键字

关键字是用来定义C#语言的字符串记号。关于关键字，一些应该知道的重要内容如下：

* **<u>关键字不能被用作变量名或者任何其他形式的标识符</u>**，除非以`@`字符开始。
* **<u>所有C#关键字全部都由小写字母组成</u>**。

## 2.4 `Main`：程序的起点

每个C#程序必须有一个类带有`Main`方法。

* 每个C#程序的可执行起点在`Main`函数中的第一条指令。
* `Main`函数的函数名称首字母必须大写。

`Main`的最简单形式如下：

```C#
static void Main()
{
    // more sentences...
    // 注意这里没有return语句
}
```

## 2.5 空白

程序中的空白指的是**<u>没有可视化输出的字符</u>**。**程序员在源代码中使用的空白将被编译器忽略，但使代码更加清晰易读**。

## 2.6 语句

语句是**<u>描述一个类型或者告诉程序去执行某个动作的一条源代码指令</u>**。简单语句以一个分号结束。

```C#
int val = 5;
System.Console.WriteLine("The value of val is {0}", val); // 格式化字符串
```

#### 块

块是由成对的大括号包围的0条或者多条语句序列，它在语法上相当于一条语句。

关于块，一些应当被了解的重要内容：

* 语法上只需要一条语句，而你需要执行的动作无法用一条简单的语句表达的情况下，考虑使用块。
* 有些特定的程序结构只能用块。在这些结构中，不能用简单语句代替块。
* 虽然简单语句以分号结束，但块后面不跟分号。

## 2.7 从程序中输出文本

控制台窗口是一种简单的命令提示窗口，允许程序显示文本并从键盘接受输入。BCL提供一个名称为`Console`的类（在`System`命名空间中），该类包含了输入和输出数据到控制台窗口的方法。

### 2.7.1 `Write`

`Write`是`Console`类的成员函数，它把一个文本字符串发送到程序的控制台窗口。最简单的情况下，**<u>`Write`将文本的字符串字面量发送到窗口，字符串必须使用双引号括起来</u>**。

```C#
Console.Write("This is trivial text."); // 输出字符串：This is trivial text.
```

发送3个文本字符串到程序的控制台窗口：

```C#
System.Console.Write("This is text1.");
System.Console.Write("This is text2.");
System.Console.Write("This is text3.");
```

这里注意：`Write`输出的字符串并没有实现换行，所以3条语句都将输出到同一行。

### 2.7.2 `WriteLine`

如果使用`WriteLine`替换掉`Write`，那么就会进行主动换行。

### 2.7.3 格式字符串

`Write`语句和`WriteLine`语句的常规形式中可以有一个以上的参数。

* **<u>如果不只一个参数，参数间用逗号分隔</u>**。

* **<u>第一个参数必须总是字符串，称为格式字符串。格式字符串可以包含替代标记</u>**。

    * 替代标记在格式字符串中标出位置，在输出串中该位置将用一个值来替代。
    * 替代标记由一个整数以及括住它的一对大括号组成，其中整数就是替换值数字的位置。跟着格式字符串的参数称为替换值，这些替换值从0开始编号。

    语法如下：

    ```C#
    Console.WriteLine("格式字符串（含替代标记）", 替换值0, 替换值1, 替换值2, ... );
    ```

### 2.7.4 多重标记和值

在C#中，可以使用任意数量的替代标记和任意数量的值。

* **<u>值可以以任何顺序使用</u>**。
* **<u>值可以在格式字符串中替换任意次</u>**。

标记不能试图引用超出替换值列表长度以外位置的值（Out of Range）。如果引用虽然不会产生编译错误，但是会产生运行时错误（异常）。

### 2.7.5 格式化数字字符串

我们希望数字以更合适的格式而不是一个简单的数字来呈现文本字符串的输出。这些就需要通过格式化字符串来实现。

```C#
Console.WriteLine("The value: {0}.", 500); // 输出一个数字
Console.WriteLine("The value: {0:C}.", 500); // 被格式化为货币
```

格式项以格式说明符形式包括了额外的信息。**<u>格式说明符语法由3个字段组成：索引号、对齐说明符和格式字段</u>**。`{index(索引), alignment(字段宽度，左右对齐):format(指定的格式)}`。

#### 对齐说明符

对齐说明符表示了字段中字符的最小宽度。并且有如下特性：

* 对齐说明符是可选的，并且使用逗号来和索引号分离。
* 它由一个正整数或者负整数组成：**<u>整数表示了字段使用字符的最少数量；符号表示了右对齐或者左对齐。正为右对齐，负为左对齐</u>**。
* 值的实际表示可能会比对齐说明符指定的字符数多一些或者少一些：
    * 如果要表示的字符数比对齐说明符中指定的字符数少，那么其余字符会使用空格填充；
    * 如果要表示的字符数多于指定的字符数，对齐说明符会被忽略，并且使用所需的字符进行表示。

#### 格式字段

格式字段指定了数字应该以哪种形式进行表示。格式字段有三部分：

* 冒号后必须紧跟格式说明符，中间不能有空格。
* 格式说明符是一个字母字符，是9个内置字符格式之一。字符可以是大写或者小写形式。
* 精度说明符是可选的，由1 - 2位数字组成。

## 2.8 注释：为代码添加注解

这部分和C以及C++一样。

### 2.8.2 文档注释

C#还提供第三种注释类型：文档注释。文档注释包含XML文本，可以用于产生程序文档。

这种类型的注释看起来好像单行注释，但是却有三个斜杠开头而不是两个。

```C#
/// <summary>
/// This class does ...
/// </summary>
class Program
{
    ...
}
```

